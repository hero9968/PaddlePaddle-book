



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Design Doc: CSP in PaddlePaddle Fluid &mdash; PaddlePaddle  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="PaddlePaddle  documentation" href="../index.html"/> 
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?b9a314ab40d04d805655aab1deee08ba";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index_en.html" class="icon icon-home"> PaddlePaddle
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
<nav class="doc-menu-vertical" role="navigation">

<ul>
<li class="toctree-l1"><a class="reference internal" href="../getstarted/index_en.html">GET STARTED</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getstarted/quickstart_en.html">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getstarted/concepts/use_concepts_en.html">Basic Concept</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../build_and_install/index_en.html">Install and Build</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../build_and_install/pip_install_en.html">Install using pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../build_and_install/docker_install_en.html">Run in Docker Containers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../build_and_install/build_from_source_en.html">Build from Sources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../howto/index_en.html">HOW TO</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../howto/cmd_parameter/index_en.html">Set Command-line Parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../howto/cmd_parameter/use_case_en.html">Use Case</a></li>
<li class="toctree-l3"><a class="reference internal" href="../howto/cmd_parameter/arguments_en.html">Argument Outline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../howto/cmd_parameter/detail_introduction_en.html">Detail Description</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../howto/cluster/index_en.html">Distributed Training</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../howto/cluster/preparations_en.html">Preparations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../howto/cluster/cmd_argument_en.html">Command-line arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../howto/cluster/multi_cluster/index_en.html">Use different clusters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../howto/cluster/multi_cluster/fabric_en.html">Fabric</a></li>
<li class="toctree-l4"><a class="reference internal" href="../howto/cluster/multi_cluster/openmpi_en.html">OpenMPI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../howto/cluster/multi_cluster/k8s_en.html">Kubernetes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../howto/cluster/multi_cluster/k8s_aws_en.html">Kubernetes on AWS</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../howto/rnn/index_en.html">RNN Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../howto/rnn/rnn_config_en.html">RNN Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../howto/rnn/recurrent_group_en.html">Recurrent Group Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../howto/rnn/hierarchical_layer_en.html">Layers supporting hierarchical sequence as input</a></li>
<li class="toctree-l3"><a class="reference internal" href="../howto/rnn/hrnn_rnn_api_compare_en.html">API comparision between RNN and hierarchical RNN</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../howto/optimization/gpu_profiling_en.html">Tune GPU Performance</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dev/index_en.html">Development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev/contribute_to_paddle_en.html">Contribute Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/write_docs_en.html">Contribute Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index_en.html">FAQ</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../faq/build_and_install/index_en.html">Install, Build and Unit test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/model/index_en.html">Model Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/parameter/index_en.html">Parameter Setting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/local/index_en.html">Local Training and Prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/cluster/index_en.html">Cluster Training and Prediction</a></li>
</ul>
</li>
</ul>

</nav>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index_en.html">PaddlePaddle</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index_en.html">Docs</a> &raquo;</li>
      
    <li>Design Doc: CSP in PaddlePaddle Fluid</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/design/csp.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="design-doc-csp-in-paddlepaddle-fluid">
<span id="design-doc-csp-in-paddlepaddle-fluid"></span><h1>Design Doc: CSP in PaddlePaddle Fluid<a class="headerlink" href="#design-doc-csp-in-paddlepaddle-fluid" title="Permalink to this headline">¶</a></h1>
<div class="section" id="motivation">
<span id="motivation"></span><h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">¶</a></h2>
<p>Concurrent programming is important for deep learning.  Few example applications are:</p>
<ol class="simple">
<li>The main thread keeps reading the next mini-batch while another thread uses the GPU for computing.</li>
<li>The main thread performs the computation while another thread uploads the local gradients from each trainer to the parameter server.</li>
</ol>
<p>Most DL systems, including TensorFlow, Caffe2, and MxNet, can asynchronously execute operators in a graph. However, Fluid doesn&#8217;t have the concept of a graph at all, as the design goal of Fluid is that of a programming language.</p>
</div>
<div class="section" id="concurrent-programming-models">
<span id="concurrent-programming-models"></span><h2>Concurrent Programming Models<a class="headerlink" href="#concurrent-programming-models" title="Permalink to this headline">¶</a></h2>
<p>There were many concurrent programming models, implemented in various forms:</p>
<p>| concurrent programming model | implementation |
|&#8212;&#8211;|&#8212;&#8211;|
| mutex | types and functions in standard libraries |
| semaphore | types and functions in standard libraries |
| communicating sequential processes (CSP) | Go programming language |
| actor model | Erlang programming language |
| message passing | MPI |
| bulk synchronous parallel (BSP) | Pregel distributed programming framework |</p>
<p>Since Fluid was designed to be a programming language, we would like to implement CSP in Fluid.</p>
<div class="section" id="csp-v-s-actor-model">
<span id="csp-v-s-actor-model"></span><h3>CSP v.s. Actor Model<a class="headerlink" href="#csp-v-s-actor-model" title="Permalink to this headline">¶</a></h3>
<p>A well-known implementation of Actor Model is the Erlang programming language.  In Actor Model, <em>processes</em> could send messages to another process and receive messages from another process given the process IDs.  We can find the three ingredients, process with ID, send, and recv, in MPI too.  Indeed, we can rewrite Erlang programs in Python + MPI with possibly fewer lines of code.  Our concern with Actor Model is that it doesn&#8217;t seem reasonable to implement process management in a programming language&#8217;s runtime library; instead, it should be the operating systems&#8217; responsibility to manage processes and libraries like MPI for send/recv.</p>
</div>
</div>
<div class="section" id="csp-in-fluid">
<span id="csp-in-fluid"></span><h2>CSP in Fluid<a class="headerlink" href="#csp-in-fluid" title="Permalink to this headline">¶</a></h2>
<p>Fluid has two fundamental control-flows: <em>if-else</em> and <em>while</em>.  If we are to implement CSP, we need the following:</p>
<ol class="simple">
<li>a new data type: <em>channel</em> and operators <em>send</em> and <em>recv</em>,</li>
<li><em>goroutine</em> or thread, and</li>
<li>a new control-flow: select.</li>
</ol>
<p>We also need Python wrappers for the above components.</p>
<p>The type <em>channel</em> is conceptually the blocking queue.  In Go, its implemented is a <a class="reference external" href="https://github.com/golang/go/blob/68ce117cf17b8debf5754bfd476345779b5b6616/src/runtime/chan.go#L31-L50">blocking circular queue</a>, which supports send and recv.</p>
<p>The <code class="docutils literal"><span class="pre">select</span></code> operation has been in OS kernels long before Go language.  All Unix kernels implement system calls <em>poll</em> and <em>select</em>.  They monitor multiple file descriptors to see if I/O is possible on any of them.  This takes O(N) time.  Since Linux 2.6, a new system call, <em>epoll</em>, can do the same in O(1) time.  In BSD systems, there is a similar system call <em>kqueue</em>.  Go&#8217;s Linux implementation uses epoll.</p>
<p>It might be a good idea to implement Fluid&#8217;s select using epoll too.  In this design doc, we start from the O(N) way so that we could focus on Python binding and the syntax.</p>
<div class="section" id="type-channel">
<span id="type-channel"></span><h3>Type Channel<a class="headerlink" href="#type-channel" title="Permalink to this headline">¶</a></h3>
<p>Fluid supports many data types:</p>
<ol class="simple">
<li>Tensor,</li>
<li>Row-sparse Tensor</li>
<li>LoD Tensor,</li>
<li>Tensor array, etc</li>
</ol>
<p>Each data type is registered in the <a class="reference external" href="https://github.com/PaddlePaddle/Paddle/blob/develop/paddle/framework/framework.proto#L117-L127"><code class="docutils literal"><span class="pre">framework.proto</span></code></a> as an enum value.  To add a new type channel, we need to add a new type enum.</p>
<p>To expose a C++ type to Python, we need to edit the <a class="reference external" href="https://github.com/PaddlePaddle/Paddle/blob/develop/paddle/pybind/pybind.cc"><code class="docutils literal"><span class="pre">pybind.cc</span></code></a> file.  <a class="reference external" href="https://github.com/PaddlePaddle/Paddle/blob/develop/paddle/pybind/pybind.cc#L120-L164">Here</a> is an example how we expose C++ class LoDTensor.</p>
</div>
</div>
<div class="section" id="syntax-design">
<span id="syntax-design"></span><h2>Syntax Design<a class="headerlink" href="#syntax-design" title="Permalink to this headline">¶</a></h2>
<div class="section" id="create-channel">
<span id="create-channel"></span><h3>Create Channel<a class="headerlink" href="#create-channel" title="Permalink to this headline">¶</a></h3>
<p>In Go, we create a channel by specifying the element type and buffer size:</p>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="nx">ch</span>  <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">int</span><span class="p">)</span>       <span class="c1">// a channel without buffer</span>
<span class="nx">ch1</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">int</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1">// a channel that can buffer 100 ints.</span>
</pre></div>
</div>
<p>In Fluid, we should be able to do the same:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">ch</span>  <span class="o">=</span> <span class="n">fluid</span><span class="o">.</span><span class="n">make_channel</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">INT</span><span class="p">)</span>
<span class="n">ch1</span> <span class="o">=</span> <span class="n">fluid</span><span class="o">.</span><span class="n">make_channel</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">INT</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>In addition to that, we want channels that can hold more complex element types, e.g., Tensors of float16:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">ch</span> <span class="o">=</span> <span class="n">fluid</span><span class="o">.</span><span class="n">make_channel</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">etype</span><span class="o">=</span><span class="n">float16</span><span class="p">)</span>
</pre></div>
</div>
<p>or Tensors of Tensors of float16 etc.</p>
<p>The point here is that we need a consistent way to compose types, like in C++ we can have <code class="docutils literal"><span class="pre">Tensor&lt;Tensor&lt;...&lt;float16&gt;...&gt;</span> <span class="pre">&gt;</span></code>.</p>
</div>
<div class="section" id="send-and-recv">
<span id="send-and-recv"></span><h3>Send and Recv<a class="headerlink" href="#send-and-recv" title="Permalink to this headline">¶</a></h3>
<p>Go&#8217;s CSP implementation depends on data type <em>channel</em>. There are two types of channels:</p>
<ol class="simple">
<li>The unblocked channel, or buffered channel, is a blocking queue with a non-zero sized buffer. The sending to buffered channel blocks if the buffer is full, and the receive operation blocks if the buffer is empty.</li>
<li>blocked channel, or unbuffered channel, is a blocking queue with no buffer.  Both sending and receiving block with unbuffered channels.</li>
</ol>
<p>There are four types of actions with a channel:</p>
<ol>
<li><p class="first">Create a channel</p>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="nx">ch</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">int</span><span class="p">)</span> <span class="c1">// this is an unbuffered channel</span>
<span class="nx">ch</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">int</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1">// this is a buffered channel of 100 ints.</span>
</pre></div>
</div>
</li>
<li><p class="first">Send</p>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="nx">ch</span> <span class="o">&lt;-</span> <span class="mi">111</span>
</pre></div>
</div>
</li>
<li><p class="first">Recv</p>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="nx">y</span><span class="p">,</span> <span class="nx">ok</span> <span class="o">&lt;-</span> <span class="nx">ch</span>
</pre></div>
</div>
</li>
<li><p class="first">Close</p>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="nb">close</span><span class="p">(</span><span class="nx">ch</span><span class="p">)</span>
</pre></div>
</div>
<p>Please be aware that a closed channel is not a nil channel, which is <code class="docutils literal"><span class="pre">var</span> <span class="pre">ch</span> <span class="pre">chan</span> <span class="pre">int</span></code>.</p>
</li>
</ol>
<p>There are some <a class="reference external" href="https://dave.cheney.net/2014/03/19/channel-axioms">axioms with channels</a>:</p>
<ol class="simple">
<li>A send to a nil channel blocks forever</li>
<li>A receive from a nil channel blocks forever</li>
<li>A send to a closed channel panics</li>
<li>A receive from a closed channel returns the residual values and then zeros.</li>
</ol>
<p>In Fluid, we have <a class="reference external" href="https://github.com/PaddlePaddle/Paddle/blob/develop/paddle/framework/details/buffered_channel.h">buffered channels</a> and <a class="reference external" href="https://github.com/PaddlePaddle/Paddle/blob/develop/paddle/framework/details/unbuffered_channel.h">unbuffered channels</a></p>
<p>The following program illustrates the Python syntax for accessing Fluid buffers.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fluid</span>

<span class="n">buffer_size</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">ch</span> <span class="o">=</span> <span class="n">fluid</span><span class="o">.</span><span class="n">make_channel</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">INT</span><span class="p">,</span> <span class="n">buffer_size</span><span class="p">)</span>

<span class="c1"># Now write three elements to the channel</span>
<span class="k">with</span> <span class="n">fluid</span><span class="o">.</span><span class="k">while</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">buffer_size</span><span class="p">):</span>
  <span class="n">fluid</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>

<span class="n">fluid</span><span class="o">.</span><span class="n">close_channel</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>

<span class="k">with</span> <span class="n">fluid</span><span class="o">.</span><span class="k">while</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">buffer_size</span><span class="p">):</span>
  <span class="n">fluid</span><span class="o">.</span><span class="k">print</span><span class="p">(</span><span class="n">fluid</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="n">ch</span><span class="p">))</span>
</pre></div>
</div>
<p>The following example shows that to avoid the always-blocking behavior of unbuffered channels, we need to use Fluid&#8217;s goroutines.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fluid</span>

<span class="n">ch</span> <span class="o">=</span> <span class="n">fluid</span><span class="o">.</span><span class="n">make_channel</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">INT</span><span class="p">)</span>

<span class="k">with</span> <span class="n">fluid</span><span class="o">.</span><span class="n">go</span><span class="p">():</span>
  <span class="n">fluid</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">fluid</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>

<span class="n">fluid</span><span class="o">.</span><span class="n">close_channel</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="select">
<span id="select"></span><h3>Select<a class="headerlink" href="#select" title="Permalink to this headline">¶</a></h3>
<p>In Go, the <code class="docutils literal"><span class="pre">select</span></code> statement lets a goroutine wait on multiple communication operations. A <code class="docutils literal"><span class="pre">select</span></code> blocks until one of its cases can run, then it executes that case. It chooses one at random if multiple are ready.</p>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="nx">ch1</span>  <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">int</span><span class="p">)</span>       
<span class="nx">ch2</span>  <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">int</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="nx">x</span> <span class="o">:=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="p">{</span>
    <span class="k">select</span> <span class="p">{</span>
    <span class="k">case</span> <span class="nx">ch1</span> <span class="o">&lt;-</span> <span class="nx">x</span><span class="p">:</span>
      <span class="nx">x</span> <span class="o">:=</span> <span class="nx">x</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">case</span> <span class="nx">y</span> <span class="o">&lt;-</span> <span class="nx">ch2</span><span class="p">:</span>
      <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Received on channel&quot;</span><span class="p">)</span>
    <span class="k">default</span><span class="p">:</span>
      <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Default&quot;</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>In Fluid, we should be able to do the same:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">ch1</span>  <span class="o">=</span> <span class="n">fluid</span><span class="o">.</span><span class="n">make_chan</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">INT</span><span class="p">)</span>
<span class="n">ch2</span> <span class="o">=</span> <span class="n">fluid</span><span class="o">.</span><span class="n">make_chan</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">INT</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">sel</span> <span class="o">=</span> <span class="n">fluid</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>

<span class="k">with</span> <span class="n">sel</span><span class="o">.</span><span class="n">case</span><span class="p">(</span><span class="n">ch1</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
    <span class="n">fluid</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">increment</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="k">with</span> <span class="n">sel</span><span class="o">.</span><span class="n">case</span><span class="p">(</span><span class="n">ch2</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="n">fluid</span><span class="o">.</span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;Received on Channel&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">sel</span><span class="o">.</span><span class="n">default</span><span class="p">():</span>
    <span class="n">fluid</span><span class="o">.</span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;Default&quot;</span><span class="p">)</span>

</pre></div>
</div>
<p>In the above code snippet, <code class="docutils literal"><span class="pre">X</span></code> and <code class="docutils literal"><span class="pre">Y</span></code> are variables. Now let us look at each of these statements one by one.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">sel.case(ch1,</span> <span class="pre">'w',</span> <span class="pre">X)</span></code> : This specifies that we are writing to <code class="docutils literal"><span class="pre">ch1</span></code> and we want to write the integer in variable <code class="docutils literal"><span class="pre">X</span></code> to the channel. The character <code class="docutils literal"><span class="pre">w</span></code> is used here to make the syntax familiar to write syntax in Python I/O.</li>
<li><code class="docutils literal"><span class="pre">sel.case(ch2,</span> <span class="pre">'r',</span> <span class="pre">Y)</span></code> : This specifies that we would like to read the result from <code class="docutils literal"><span class="pre">ch2</span></code> into variable <code class="docutils literal"><span class="pre">Y</span></code>. The character <code class="docutils literal"><span class="pre">r</span></code> is used here to make the syntax familiar to read syntax in Python I/O.</li>
<li><code class="docutils literal"><span class="pre">sel.default()</span></code> : This is equivalent to the default in Go <code class="docutils literal"><span class="pre">select</span></code>. If none of the channels are ready for read or write, then the fluid code in the default block will be executed.</li>
</ul>
</div>
</div>
<div class="section" id="example-programs">
<span id="example-programs"></span><h2>Example Programs<a class="headerlink" href="#example-programs" title="Permalink to this headline">¶</a></h2>
<div class="section" id="rpc-between-trainers-and-parameter-servers">
<span id="rpc-between-trainers-and-parameter-servers"></span><h3>1. RPC between Trainers and Parameter Servers<a class="headerlink" href="#rpc-between-trainers-and-parameter-servers" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="concurrent-minibatch-loading">
<span id="concurrent-minibatch-loading"></span><h3>2. Concurrent Minibatch Loading<a class="headerlink" href="#concurrent-minibatch-loading" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, PaddlePaddle developers.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>